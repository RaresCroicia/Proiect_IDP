_format_version: "3.0"
_transform: true

services:
  - name: auth-service
    url: http://auth-service:3000
    routes:
      - name: auth-routes
        paths:
          - /auth
        methods:
          - POST
          - GET
        strip_path: true

  - name: course-service
    url: http://course-service:3000
    routes:
      - name: course-routes
        paths:
          - /courses
        methods:
          - GET
          - POST
          - PUT
          - DELETE
        strip_path: true

  - name: ingestion-service
    url: http://ingestion-service:3000
    routes:
      - name: ingestion-routes
        paths:
          - /api
        methods:
          - GET
          - POST
          - PUT
          - DELETE
        strip_path: true

  - name: frontend
    url: http://frontend:3000
    routes:
      - name: frontend-routes
        paths:
          - /
        methods:
          - GET
        strip_path: false

plugins:
  - name: cors
    config:
      origins: ["*"]
      methods: ["GET", "POST", "PUT", "DELETE", "OPTIONS"]
      headers: ["Accept", "Authorization", "Content-Type"]
      exposedHeaders: ["*"]
      credentials: true
      maxAge: 3600

  - name: rate-limiting
    config:
      minute: 100
      hour: 1000
      policy: local

  - name: key-auth
    enabled: false
    config:
      key_names: ["X-API-Key"]
      hide_credentials: true 